# Graver

This project is intended to automate the creation of user documentation when building a project for a client.  For me it was always the last thing to do, and I never liked doing it.  So like anything that I hate doing, I decided to automate it.

It's intended to work with Protractor, and therefore sets it as a `peerDependency`.

## Installation

Using NPM (or Yarn if that's your bag) install it as a `devDependency`:
```
$ npm install --save-dev graver
```

Once it's been installed, enable it by listing it as a reporter in your Protractor configuration file:
```
// protractor.conf.js
const { Graver } = require('graver');

exports.config = {
	// ...
	onPrepare() {
		jasmine.getEnv().addReporter(
			new Graver({
				// options
			})
	    );
    }
}
```

## Options

The available properties in the options object customize the output.

### `title`: string = 'User Guides'

This sets the title property in the output.  If you're building to the default HTML output, it will set the title at the top of the page.

### `imagePath`: string = './results/screenshots/'

The output path for images taken.  By default it creates a `results/` folder in the CWD where tests are run, and adds a `screenshots/` folder for storing images.  Whether you use the default, or customize your own path for images, thumbnail versions will be stored in a sub-directory called `thumbs/`
  
### `fileName`: string = './results/report'

The path and name of the output file, without the extension.  This file will house the full output data, with references through relative paths to the images generated and stored in `imagePath`.

### `fileType`: '.html' | '.json' = '.html`

The final option gives you the opportunity to either use the built-in HTML page generated by the reporter, or output data to a JSON file so that you can build your own templates for viewing user guides.  While a lot of (and probably way too much) work went into putting together a decent default HTML view, most people will probably want to customize their own before they show any of these guides to their customers.
  
## Contributions

This project is written in TypeScript and follows an object-oriented mentality.  Please feel free to fork/commit/PR any new features that you'd like to see.  If you come across any problems, please let me know by opening an issue in the issues tab. 

## Usage

Similar to how tests are broken into suites and specs, Graver breaks up its guide generation flow into `Guides` and `Steps` - each `Guide` is a collection of `Steps`.  In full transparency, they're both just wrappers for the Jasmine `describe` and `it` functions; although in wrapping those functions they add quite a bit of functionality to them.

To create a `Guide`, you would first create a series of `Steps`.  Here's an example:
```
import { PokemonPage } from './pokemon.po';
import { Guide, Step } from '../../tractorPull/dist';

const steps:Step[] = [
	// ...
	new Step('Open Pokemon Details', 'Clicking on a Pokemon will open that particular Pokemon\'s detailed listing.', '.modal__inner', function () {
		let page:PokemonPage = new PokemonPage();
		page.navigateTo();
		page.getFirstPokemonCardElement().click();
	}),
	// ...
];

new Guide('Using the Pokemon Viewer', 'This guide takes you through the steps of viewing the various Pokemon.', ...steps);
```

A `Step` constructor takes the following arguments:
- `title: string` - the title of the individual item in the user guide
- `description: string` - the description of the individual item in the user guide
- `cssSelector: string | null` - a CSS selector identifying the element to which the screenshot should be cropped; if null, it will be an image capture of the entire browser window
- `execution: () => void` - an execution function telling Protractor what to do in order to demonstrate what is described

A `Guide` constructor takes the following arguments:
- `title: string` - the title of the suite of `Steps` in the user guide
- `description: string` - the description of the suite of `Steps` in the user guide
- `...specs: Step` - an unlimited number of `Steps` passed in as arguments, in order of execution

### Screenshots

This reporter is intended for auto-generating documentation, and therefore **is not intended to show the status of tests**. As such, your `Steps` need not have any assertions written.  Once the execution function in each `Step` comes to completion, a screenshot will be taken, and the runner will move on to the next `Step`.

Note that a `Step` screenshot happens once all functions in the `execution` argument are done.  Therefore if the purpose of a `Step` is to, for example, highlight a button that a user is intended to click, the `Step` would go so far as to bring the button into view, but not to click it.  
